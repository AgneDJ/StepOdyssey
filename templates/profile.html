{% extends 'base.html' %}
{% include 'friend_request.html' %}
{% include 'Invite_to_challenge.html' %}
{% block content %}
     
        Hi {{user.user_name}}! Welcome to Step Odyssey!
       
        <div class="rounded-circle shadow-4">
            <img id="myImg" src="{{user.user_avatar}}" class="rounded-circle shadow-4" style="width: 100px;" alt="Avatar" />
        </div>
        <br>
        

        <form action="/sync">
            <button type="submit" class="btn btn-primary">Sync data</button>
        </form>
        <form action="/logout">
            <button type="submit" class="btn btn-primary">Log out</button>
        </form>
        <div class="container">

            <div class="row">
                <div class="col-sm-3">User</div>
                <div class="col-sm-3"></div>
                <div class="col-sm-3">Daily Total Steps</div>
                <div class="col-sm-3">Lifetime Steps</div>
              </div>
              <div class="row">
                <div class="col-sm"></div>
                <div class="col-sm"></div>
                <div class="col-sm">{{date}} - {{daily_total}}</div>
                <div class="col-sm">{{lifetime_steps}}</div>
              </div>
            </div>
        <div class="container">
           
            {% if user_achievements %}
            <div class="row">
                <div class="col-sm-6"><h1>Your achievements</h1></div>
                <div class="col-sm-6"></div>
                {% for user_achievement in user_achievements %}
                <div class="col-sm-2"><img src={{user_achievement.achievements.image}} class="rounded-circle shadow-4" style="width: 100px;" alt="Achievements image">
                    <br>
                <div class="col-sm-7">{{user_achievement.achievements.title}}</div>
            </div>
                {% endfor %}
            
            {% endif %} 
              <div class="col-sm-14"><h1>Your challenges</h1></div>
                <div class="row">
                    <div class="col-sm-14">Title</div>
                    <!-- <div class="col-sm-1">Duration</div>
                    <div class="col-sm-1">Goal</div> -->
                    <div class="col-sm-1">Duration</div>
                    <div class="col-sm-1">Invite</div>
                    <div class="col-sm-1">status?</div>
                </div>
                    {% for row in user_challenges %}
                <div class="row">
                    <div class="col-sm-1">{{row['user_challenge'].challenges.title}}</div>
                    <div class="col-sm-1">{{row['progress']}}</div>
                    <div class="col-sm-1">{{row['complete']}}</div>
                    <!-- <div class="col-sm-1">{{row['user_challenge'].challenges.duration}}</div>
                    <div class="col-sm-1">{{row['user_challenge'].challenges.total_to_compete}}</div> -->
                    <div class="col-sm-1">{{row['duration']}}</div>
                    <div class="col-sm-1">
                    <div class="col-sm-1"></div><p>{{row['status']}}</p></div> 
                    {% for user in friends_list %}
                        {% if row['status'] == "In progress" %}
                        <div class="col-sm-1"><div class="dropdown">
                            <button class="dropbtn">Invite Friends</button>
                            <div class="dropdown-content">
                                <td scope="col"><button class="btn btn-outline-success my-2 my-sm-0" id="inviting-{{user.user_id}}-{{row['user_challenge'].challenges.challenge_id}}" type="submit"><a href="#">{{user.user_name}}</a></button></td>
                            </div>
                        </div>
                        {% endif %}
                        <table class="table table-dark">
                            <thead>
                              <tr>
                                <th scope="col">Friend</th>
                                <th scope="col">Progress</th>
                              </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="col">friends_name</th>
                                    <th scope="col">friends_progress    </th>

                                    <!-- friends name and steps  -->
                                    <!-- join button not permanent -->
                                    <!-- more steps sync -->
                                  </tr>
                            </tbody>
                        </table>
                    {% endfor %}
                </div>  
                {% endfor %}  
                  
                </div>  
            </div>
        </div>

        <script type="text/javascript">
        //     window.addEventListener('load', function() {document.querySelector('input[type="file"]').addEventListener('change', function() {
        //         let img = document.querySelector('.avatar');   
        //         console.log("0000000000000000000"+ img) 
        //         if (this.files && this.files[0]) {
        //             img.onload = () => {
        //                 URL.revokeObjectURL(img.src);
        //             };
        //             img.src = URL.createObjectURL(this.files[0]); 
        //         }
        //     });
        // });
    </script>
    <script src="/static/invite.js"></script>
       
{% endblock %} 
